<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIOXY | EU-Compliant Sustainability Platform</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', system-ui, sans-serif;
        }

        :root {
            --primary: #0A2540;
            --primary-light: #1A365D;
            --primary-dark: #061B2E;
            --secondary: #00D4AA;
            --secondary-dark: #00B894;
            --accent: #FF6B6B;
            --light: #F8FAFC;
            --dark: #2D3748;
            --gray: #718096;
            --border: #E2E8F0;
            --card-bg: #FFFFFF;
            --success: #48BB78;
            --warning: #ED8936;
            --gradient-primary: linear-gradient(135deg, #0A2540 0%, #1A365D 100%);
            --gradient-secondary: linear-gradient(135deg, #00D4AA 0%, #00B894 100%);
            --gradient-accent: linear-gradient(135deg, #FF6B6B 0%, #FF8E8E 100%);
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
            --shadow-xl: 0 20px 40px rgba(0,0,0,0.15);
        }

        body {
            background: linear-gradient(135deg, #F8FAFC 0%, #EDF2F7 100%);
            min-height: 100vh;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .header {
            background: var(--gradient-primary);
            color: white;
            padding: 2.5rem 3rem;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.05);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .logo {
            font-size: 2.75rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-icon {
            background: var(--gradient-secondary);
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            box-shadow: var(--shadow-md);
        }

        .tagline {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        .compliance-badge {
            background: rgba(255,255,255,0.15);
            padding: 0.6rem 1.25rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 0 3rem;
            position: relative;
        }

        .nav-tab {
            padding: 1.25rem 2rem;
            background: none;
            border: none;
            font-weight: 600;
            color: var(--gray);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
            overflow: hidden;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-primary);
            opacity: 0.05;
            transition: left 0.3s ease;
        }

        .nav-tab:hover::before {
            left: 0;
        }

        .nav-tab.active {
            color: var(--primary);
            border-bottom-color: var(--secondary);
        }

        .nav-tab.active::before {
            left: 0;
        }

        .main-content {
            padding: 2.5rem 3rem;
            display: grid;
            gap: 2rem;
            grid-template-columns: 1fr 1fr;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .card-title {
            font-size: 1.375rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }

        .form-control {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(10, 37, 64, 0.1);
        }

        .btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 0.875rem 1.75rem;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: var(--shadow-sm);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-success {
            background: var(--gradient-secondary);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .ingredient-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            margin-top: 1.5rem;
        }

        .ingredient-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.25rem;
            border-bottom: 1px solid var(--border);
            transition: background 0.2s;
        }

        .ingredient-item:hover {
            background: rgba(0, 212, 170, 0.05);
        }

        .ingredient-item:last-child {
            border-bottom: none;
        }

        .ingredient-info {
            flex: 1;
        }

        .ingredient-name {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .ingredient-stats {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .ingredient-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .quantity-input {
            width: 90px;
            padding: 0.5rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            text-align: center;
        }

        .remove-btn {
            background: var(--gradient-accent);
            color: white;
            border: none;
            border-radius: 6px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .remove-btn:hover {
            transform: scale(1.1);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .metric-card {
            background: white;
            padding: 2rem 1.5rem;
            border-radius: 14px;
            text-align: center;
            box-shadow: var(--shadow-md);
            border-top: 4px solid var(--primary);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-primary);
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .metric-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(10, 37, 64, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
            margin: 0.5rem 0;
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .savings-badge {
            background: var(--gradient-secondary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 600;
            margin-top: 0.75rem;
            display: inline-block;
            box-shadow: var(--shadow-sm);
        }

        .chart-container {
            height: 320px;
            margin: 2.5rem 0;
            background: white;
            border-radius: 14px;
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
        }

        .environmental-story {
            background: var(--gradient-primary);
            color: white;
            padding: 2.5rem;
            border-radius: 16px;
            margin: 2.5rem 0;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .environmental-story::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 200%;
            background: rgba(255,255,255,0.05);
            transform: rotate(30deg);
        }

        .story-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .story-content {
            line-height: 1.7;
            font-size: 1.05rem;
            position: relative;
            z-index: 2;
        }

        .story-highlight {
            background: rgba(255,255,255,0.15);
            padding: 0.75rem 1.25rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid var(--secondary);
        }

        .compliance-notice {
            background: #E3F2FD;
            border: 1px solid #2196F3;
            border-radius: 12px;
            padding: 1.75rem;
            margin: 2rem 0;
            font-size: 0.95rem;
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .compliance-icon {
            background: #2196F3;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            padding: 3rem;
        }

        .spinner {
            border: 4px solid rgba(10, 37, 64, 0.1);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .transport-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .advanced-options {
            background: var(--light);
            border-radius: 12px;
            padding: 1.75rem;
            margin-top: 1.5rem;
            border-left: 4px solid var(--primary);
        }

        .section-divider {
            height: 1px;
            background: var(--border);
            margin: 2rem 0;
        }

        .footer {
            background: var(--primary-dark);
            color: white;
            padding: 2rem 3rem;
            text-align: center;
            font-size: 0.9rem;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-links {
            display: flex;
            gap: 2rem;
        }

        .footer-links a {
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer-links a:hover {
            color: white;
        }

        .progress-bar {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            margin: 1rem 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-secondary);
            border-radius: 3px;
            transition: width 0.5s ease;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 220px;
            background: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 0.75rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            font-weight: normal;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(0, 212, 170, 0.1);
            color: var(--secondary-dark);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .tab-indicator {
            position: absolute;
            bottom: 0;
            height: 3px;
            background: var(--secondary);
            transition: left 0.3s ease, width 0.3s ease;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--gray);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-leaf"></i>
                    </div>
                    AIOXY
                </div>
                <div class="tagline">EU-Compliant Sustainability Intelligence Platform</div>
                <div class="compliance-badge">
                    <i class="fas fa-shield-alt"></i>
                    EU Green Claims Directive Compliant
                </div>
            </div>
        </div>

        <div class="nav-tabs">
            <div class="tab-indicator" id="tabIndicator"></div>
            <button class="nav-tab active" onclick="showTab('calculator')">
                <i class="fas fa-calculator"></i>
                Calculator
            </button>
            <button class="nav-tab" onclick="showTab('results')">
                <i class="fas fa-chart-line"></i>
                Results
            </button>
            <button class="nav-tab" onclick="showTab('compliance')">
                <i class="fas fa-file-contract"></i>
                Compliance
            </button>
        </div>

        <div class="main-content">
            <!-- Calculator Tab -->
            <div id="calculator-tab" class="tab-content">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-box"></i>
                            </div>
                            Product Information
                        </div>
                        <div class="badge">
                            <i class="fas fa-info-circle"></i>
                            Required for DPP
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Product Name</label>
                        <input type="text" id="productName" value="Plant-Based Protein Burger" class="form-control" placeholder="Enter product name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Product Category</label>
                        <select class="form-control">
                            <option>Food & Beverage</option>
                            <option>Personal Care</option>
                            <option>Household Products</option>
                            <option>Textiles</option>
                            <option>Electronics</option>
                        </select>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-apple-alt"></i>
                            </div>
                            Ingredients
                        </div>
                        <div class="badge">
                            <i class="fas fa-database"></i>
                            35+ Options
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Select Ingredient</label>
                        <select id="ingredientSelect" class="form-control">
                            <option value="">Choose from 35+ ingredients...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Quantity (kg)</label>
                        <input type="number" id="ingredientQuantity" value="0.150" step="0.001" min="0" class="form-control">
                    </div>
                    <button class="btn" onclick="addIngredient()">
                        <i class="fas fa-plus"></i>
                        Add Ingredient
                    </button>
                    
                    <div class="ingredient-list" id="ingredientList">
                        <!-- Ingredients will be added here -->
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-industry"></i>
                            </div>
                            Manufacturing & Supply Chain
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Manufacturing Country</label>
                        <select id="manufacturingCountry" class="form-control">
                            <option value="">Select country...</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Processing Method</label>
                        <select id="processingMethod" class="form-control">
                            <option value="none">No Additional Processing</option>
                            <option value="pasteurization">Pasteurization</option>
                            <option value="sterilization">Sterilization</option>
                            <option value="baking">Baking</option>
                            <option value="frying">Frying</option>
                            <option value="freezing">Freezing (IQF)</option>
                            <option value="drying">Spray Drying</option>
                            <option value="milling">Milling</option>
                            <option value="mixing">Mixing</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Transportation</label>
                        <div class="transport-section">
                            <div>
                                <label class="form-label">Distance (km)</label>
                                <input type="number" id="transportDistance" value="300" min="0" class="form-control">
                            </div>
                            <div>
                                <label class="form-label">Transport Mode</label>
                                <select id="transportMode" class="form-control">
                                    <option value="road">Road (HGV Diesel)</option>
                                    <option value="rail">Rail (Electric)</option>
                                    <option value="sea">Sea (Container)</option>
                                    <option value="air">Air Freight</option>
                                    <option value="lastmile">Last-mile Delivery</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <button class="btn btn-outline" onclick="toggleAdvanced()">
                        <i class="fas fa-cog"></i>
                        Advanced Options
                    </button>

                    <div class="advanced-options hidden" id="advancedOptions">
                        <div class="form-group">
                            <label class="form-label">Refrigerated Transport</label>
                            <select id="refrigeratedTransport" class="form-control">
                                <option value="no">No Refrigeration</option>
                                <option value="yes">Refrigerated (+20% emissions)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Energy Source</label>
                            <select class="form-control">
                                <option>Grid Mix (Regional)</option>
                                <option>Renewable Energy</option>
                                <option>Natural Gas</option>
                                <option>Coal</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-box-open"></i>
                            </div>
                            Packaging Materials
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Primary Packaging Material</label>
                        <select id="packagingMaterial" class="form-control">
                            <option value="cardboard">Cardboard (Coated)</option>
                            <option value="PET">PET Plastic</option>
                            <option value="HDPE">HDPE Plastic</option>
                            <option value="LDPE">LDPE Plastic</option>
                            <option value="PP">PP Plastic</option>
                            <option value="glass">Glass</option>
                            <option value="aluminum">Aluminum</option>
                            <option value="steel">Steel</option>
                            <option value="PLA">PLA Bioplastic</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Packaging Weight (kg)</label>
                        <input type="number" id="packagingWeight" value="0.050" step="0.001" min="0" class="form-control">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Recycled Content (%)</label>
                        <input type="number" id="recycledContent" value="30" min="0" max="100" class="form-control">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 30%;"></div>
                        </div>
                    </div>
                </div>

                <button class="btn btn-success" onclick="calculateImpact()" style="width: 100%; padding: 1.25rem; font-size: 1.1rem;">
                    <i class="fas fa-rocket"></i>
                    Calculate Environmental Impact
                </button>
            </div>

            <!-- Results Tab -->
            <div id="results-tab" class="tab-content hidden">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            Sustainability Impact Analysis
                        </div>
                        <div class="badge">
                            <i class="fas fa-clock"></i>
                            Updated just now
                        </div>
                    </div>
                    
                    <div class="loading hidden" id="loadingResults">
                        <div class="spinner"></div>
                        <h3>Calculating comprehensive environmental impact...</h3>
                        <p style="font-size: 0.95rem; color: var(--gray); margin-top: 0.5rem;">
                            Processing 35+ ingredients with regionalized AWARE factors and CFF packaging calculations
                        </p>
                    </div>

                    <div id="resultsContent">
                        <div class="results-grid">
                            <div class="metric-card">
                                <div class="metric-icon">
                                    <i class="fas fa-smog"></i>
                                </div>
                                <div class="metric-value" id="co2Value">0.00 kg</div>
                                <div class="metric-label">CO₂e per kg</div>
                                <div class="savings-badge" id="co2Savings">0% saved</div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-icon">
                                    <i class="fas fa-tint"></i>
                                </div>
                                <div class="metric-value" id="waterValue">0 L</div>
                                <div class="metric-label">Water per kg</div>
                                <div class="savings-badge" id="waterSavings">0% saved</div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-icon">
                                    <i class="fas fa-mountain"></i>
                                </div>
                                <div class="metric-value" id="landValue">0.00 m²</div>
                                <div class="metric-label">Land Use per kg</div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-icon">
                                    <i class="fas fa-water"></i>
                                </div>
                                <div class="metric-value" id="waterScarcityValue">0.000</div>
                                <div class="metric-label">Water Scarcity (m³ eq)</div>
                            </div>
                        </div>

                        <div class="chart-container">
                            <canvas id="emissionChart"></canvas>
                        </div>

                        <div class="environmental-story">
                            <div class="story-title">
                                <i class="fas fa-globe-europe"></i>
                                Environmental Impact Story
                            </div>
                            <div class="story-content" id="storyContent">
                                <div class="story-highlight">
                                    Add ingredients to see your sustainability story and environmental impact narrative.
                                </div>
                                <p>
                                    Your product's environmental footprint tells a story about resource efficiency, supply chain optimization, and sustainability commitments. 
                                    Once you add ingredients and calculate impacts, we'll provide a comprehensive narrative that highlights your environmental performance.
                                </p>
                            </div>
                        </div>

                        <div class="compliance-notice">
                            <div class="compliance-icon">
                                <i class="fas fa-check"></i>
                            </div>
                            <div>
                                <strong>EU Green Claims Directive Compliant</strong><br>
                                This assessment follows PEF methodology using AGRIBALYSE 3.2, JRC EF 3.2, and AWARE 2.0 data. 
                                All claims are substantiated and auditable through the Digital Product Passport (DPP).
                            </div>
                        </div>

                        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                            <button class="btn">
                                <i class="fas fa-file-pdf"></i>
                                Export DPP Report
                            </button>
                            <button class="btn">
                                <i class="fas fa-search"></i>
                                Generate Verification
                            </button>
                            <button class="btn btn-outline">
                                <i class="fas fa-share-alt"></i>
                                Share Results
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Compliance Tab -->
            <div id="compliance-tab" class="tab-content hidden">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-file-certificate"></i>
                            </div>
                            Compliance & Documentation
                        </div>
                    </div>
                    
                    <div class="compliance-notice">
                        <div class="compliance-icon">
                            <i class="fas fa-gavel"></i>
                        </div>
                        <div>
                            <strong>EU Regulatory Compliance Statement</strong><br><br>
                            Environmental claims made by AIOXY regarding this product are substantiated by a Life Cycle Assessment (LCA) conducted in accordance with the Product Environmental Footprint (PEF) methodology as defined by the European Commission Joint Research Centre (JRC).<br><br>
                            The specific methodology, including data sources (AGRIBALYSE 3.2, JRC EF 3.2, GLEC v3.1) and calculation rules (CFF, AWARE, Economic Allocation), is fully documented and auditable via the Digital Product Passport (DPP). This claim refers exclusively to, and not to the product's overall environmental performance.
                        </div>
                    </div>
                    
                    <h3 style="margin: 2rem 0 1rem 0; color: var(--primary);">Methodology Used</h3>
                    
                    <div class="results-grid">
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-tint"></i>
                            </div>
                            <div class="metric-value">AWARE</div>
                            <div class="metric-label">Water Scarcity</div>
                            <p style="margin-top: 1rem; font-size: 0.9rem;">
                                Regionalized water impact assessment with 0.1-100 constraint factors
                            </p>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-recycle"></i>
                            </div>
                            <div class="metric-value">CFF</div>
                            <div class="metric-label">Circular Footprint</div>
                            <p style="margin-top: 1rem; font-size: 0.9rem;">
                                Packaging end-of-life calculations with R1, R2, Q parameters
                            </p>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="metric-value">PEF</div>
                            <div class="metric-label">Allocation</div>
                            <p style="margin-top: 1rem; font-size: 0.9rem;">
                                PEF-compliant economic allocation for co-products
                            </p>
                        </div>
                        
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-map-marked-alt"></i>
                            </div>
                            <div class="metric-value">Regional</div>
                            <div class="metric-label">Factors</div>
                            <p style="margin-top: 1rem; font-size: 0.9rem;">
                                Country-specific electricity and water scarcity factors
                            </p>
                        </div>
                    </div>

                    <div class="section-divider"></div>

                    <h3 style="margin: 2rem 0 1rem 0; color: var(--primary);">Data Sources & Verification</h3>
                    <ul style="line-height: 1.7; margin-left: 1.5rem;">
                        <li><strong>AGRIBALYSE 3.2</strong>: Comprehensive agricultural LCA database</li>
                        <li><strong>JRC EF 3.2</strong>: European Commission's emission factors</li>
                        <li><strong>GLEC v3.1</strong>: Global Logistics Emissions Council framework</li>
                        <li><strong>AWARE 2.0</strong>: UNEP/SETAC water scarcity method</li>
                        <li><strong>Ecoinvent 3.8</strong>: Background system data</li>
                    </ul>

                    <div style="display: flex; gap: 1rem; margin-top: 2.5rem;">
                        <button class="btn">
                            <i class="fas fa-file-download"></i>
                            Download Methodology
                        </button>
                        <button class="btn btn-outline">
                            <i class="fas fa-user-check"></i>
                            Request Audit
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div class="footer-content">
                <div>© 2023 AIOXY Sustainability Intelligence. All rights reserved.</div>
                <div class="footer-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                    <a href="#">Documentation</a>
                    <a href="#">Contact</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ================== COMPLETE AIOXY DATASET FROM GEMINI ==================
        const aioxyData = {
            // ALL 35 INGREDIENTS FROM GEMINI TABLE A
            ingredients: {
                "beef": { name: "Beef (Cattle, EU Conventional)", co2: 22.10, waterBlue: 120.0, waterGreen: 1500.0, waterGrey: 15.0, landUse: 14.5, loss: 0.035 },
                "chicken": { name: "Chicken (Broiler, EU Average)", co2: 4.30, waterBlue: 5.5, waterGreen: 65.0, waterGrey: 2.5, landUse: 1.8, loss: 0.025 },
                "pork": { name: "Pork (Pig, EU Average)", co2: 7.40, waterBlue: 15.0, waterGreen: 180.0, waterGrey: 4.0, landUse: 2.9, loss: 0.020 },
                "salmon": { name: "Salmon (Farmed)", co2: 3.60, waterBlue: 0.8, waterGreen: 0.5, waterGrey: 0.1, landUse: 0.5, loss: 0.010 },
                "milk": { name: "Milk (Cow, UHT)", co2: 1.15, waterBlue: 1.2, waterGreen: 8.0, waterGrey: 0.5, landUse: 0.9, loss: 0.005 },
                "eggs": { name: "Eggs (Chicken)", co2: 3.20, waterBlue: 2.5, waterGreen: 25.0, waterGrey: 1.0, landUse: 1.1, loss: 0.005 },
                "wheat": { name: "Wheat (Grain)", co2: 0.50, waterBlue: 5.0, waterGreen: 550.0, waterGrey: 3.5, landUse: 0.3, loss: 0.030 },
                "rice": { name: "Rice (Paddy)", co2: 3.50, waterBlue: 85.0, waterGreen: 1100.0, waterGrey: 10.0, landUse: 0.9, loss: 0.050 },
                "corn": { name: "Corn (Maize)", co2: 0.60, waterBlue: 4.5, waterGreen: 400.0, waterGrey: 2.0, landUse: 0.4, loss: 0.040 },
                "oats": { name: "Oats (Grain)", co2: 0.45, waterBlue: 3.0, waterGreen: 350.0, waterGrey: 1.5, landUse: 0.2, loss: 0.030 },
                "soybeans": { name: "Soybeans (Dried)", co2: 0.75, waterBlue: 10.0, waterGreen: 1200.0, waterGrey: 5.0, landUse: 1.5, loss: 0.020 },
                "peas": { name: "Peas (Dried)", co2: 0.40, waterBlue: 1.5, waterGreen: 450.0, waterGrey: 1.0, landUse: 0.3, loss: 0.010 },
                "lentils": { name: "Lentils (Dried)", co2: 0.85, waterBlue: 10.0, waterGreen: 700.0, waterGrey: 3.0, landUse: 0.5, loss: 0.010 },
                "chickpeas": { name: "Chickpeas (Dried)", co2: 0.95, waterBlue: 15.0, waterGreen: 850.0, waterGrey: 4.0, landUse: 0.7, loss: 0.010 },
                "almonds": { name: "Almonds (Kernel)", co2: 7.50, waterBlue: 550.0, waterGreen: 1500.0, waterGrey: 20.0, landUse: 2.5, loss: 0.005 },
                "potatoes": { name: "Potatoes (Fresh)", co2: 0.30, waterBlue: 1.0, waterGreen: 120.0, waterGrey: 0.5, landUse: 0.1, loss: 0.050 },
                "tomatoes": { name: "Tomatoes (Fresh, Field)", co2: 0.55, waterBlue: 5.0, waterGreen: 150.0, waterGrey: 1.0, landUse: 0.3, loss: 0.040 },
                "onions": { name: "Onions (Fresh)", co2: 0.25, waterBlue: 0.8, waterGreen: 80.0, waterGrey: 0.3, landUse: 0.1, loss: 0.040 },
                "carrots": { name: "Carrots (Fresh)", co2: 0.20, waterBlue: 0.5, waterGreen: 60.0, waterGrey: 0.2, landUse: 0.1, loss: 0.030 },
                "apples": { name: "Apples (Fresh)", co2: 0.40, waterBlue: 2.0, waterGreen: 180.0, waterGrey: 0.5, landUse: 0.2, loss: 0.030 },
                "bananas": { name: "Bananas (Fresh)", co2: 0.95, waterBlue: 1.5, waterGreen: 150.0, waterGrey: 0.8, landUse: 0.4, loss: 0.020 },
                "oranges": { name: "Oranges (Fresh)", co2: 0.50, waterBlue: 3.0, waterGreen: 200.0, waterGrey: 1.0, landUse: 0.3, loss: 0.020 },
                "berries": { name: "Berries (Mixed, Fresh)", co2: 1.80, waterBlue: 10.0, waterGreen: 300.0, waterGrey: 5.0, landUse: 0.6, loss: 0.050 },
                "palm-oil": { name: "Palm Oil (Crude)", co2: 3.50, waterBlue: 15.0, waterGreen: 200.0, waterGrey: 5.0, landUse: 3.0, loss: 0.010 },
                "olive-oil": { name: "Olive Oil", co2: 6.00, waterBlue: 120.0, waterGreen: 1500.0, waterGrey: 8.0, landUse: 4.0, loss: 0.010 },
                "sunflower-oil": { name: "Sunflower Oil", co2: 1.50, waterBlue: 5.0, waterGreen: 500.0, waterGrey: 2.5, landUse: 0.8, loss: 0.010 },
                "sugar-cane": { name: "Sugar Cane", co2: 0.70, waterBlue: 80.0, waterGreen: 1000.0, waterGrey: 6.0, landUse: 0.5, loss: 0.030 },
                "sugar-beet": { name: "Sugar Beet", co2: 0.60, waterBlue: 5.0, waterGreen: 400.0, waterGrey: 2.0, landUse: 0.3, loss: 0.020 },
                "honey": { name: "Honey", co2: 1.30, waterBlue: 1.0, waterGreen: 20.0, waterGrey: 0.1, landUse: 0.5, loss: 0.005 },
                "coffee": { name: "Coffee (Roasted)", co2: 17.50, waterBlue: 80.0, waterGreen: 1500.0, waterGrey: 12.0, landUse: 8.0, loss: 0.010 },
                "cocoa": { name: "Cocoa (Powder)", co2: 22.50, waterBlue: 150.0, waterGreen: 2500.0, waterGrey: 18.0, landUse: 12.0, loss: 0.010 },
                "tea": { name: "Tea (Black, Dried)", co2: 2.20, waterBlue: 5.0, waterGreen: 400.0, waterGrey: 3.0, landUse: 0.8, loss: 0.005 },
                "salt": { name: "Salt", co2: 0.01, waterBlue: 0.0, waterGreen: 0.0, waterGrey: 0.0, landUse: 0.0, loss: 0.000 },
                "yeast": { name: "Yeast (Brewer's)", co2: 1.20, waterBlue: 4.0, waterGreen: 10.0, waterGrey: 0.5, landUse: 0.1, loss: 0.001 },
                "algae-protein": { name: "Algae Protein (Microalgae)", co2: 1.70, waterBlue: 8.0, waterGreen: 2.0, waterGrey: 0.1, landUse: 0.2, loss: 0.005 }
            },

            // 22 COUNTRIES FROM GEMINI TABLE E
            countries: {
                "DE": { name: "Germany", electricityCO2: 365.0, awareFactor: 0.85 },
                "FR": { name: "France", electricityCO2: 70.0, awareFactor: 1.10 },
                "IT": { name: "Italy", electricityCO2: 350.0, awareFactor: 1.80 },
                "ES": { name: "Spain", electricityCO2: 220.0, awareFactor: 2.50 },
                "NL": { name: "Netherlands", electricityCO2: 390.0, awareFactor: 0.95 },
                "PL": { name: "Poland", electricityCO2: 700.0, awareFactor: 0.75 },
                "SE": { name: "Sweden", electricityCO2: 35.0, awareFactor: 0.10 },
                "DK": { name: "Denmark", electricityCO2: 150.0, awareFactor: 0.15 },
                "BE": { name: "Belgium", electricityCO2: 250.0, awareFactor: 1.00 },
                "UK": { name: "United Kingdom", electricityCO2: 270.0, awareFactor: 1.20 },
                "IE": { name: "Ireland", electricityCO2: 330.0, awareFactor: 0.90 },
                "AT": { name: "Austria", electricityCO2: 120.0, awareFactor: 0.50 },
                "FI": { name: "Finland", electricityCO2: 110.0, awareFactor: 0.10 },
                "PT": { name: "Portugal", electricityCO2: 180.0, awareFactor: 1.90 },
                "GR": { name: "Greece", electricityCO2: 480.0, awareFactor: 3.00 },
                "US": { name: "United States", electricityCO2: 400.0, awareFactor: 1.50 },
                "CA": { name: "Canada", electricityCO2: 150.0, awareFactor: 0.40 },
                "AU": { name: "Australia", electricityCO2: 550.0, awareFactor: 2.20 },
                "JP": { name: "Japan", electricityCO2: 450.0, awareFactor: 0.80 },
                "CN": { name: "China", electricityCO2: 580.0, awareFactor: 5.00 },
                "IN": { name: "India", electricityCO2: 650.0, awareFactor: 15.00 },
                "BR": { name: "Brazil", electricityCO2: 120.0, awareFactor: 3.50 }
            },

            // PROCESSING METHODS FROM GEMINI TABLE C
            processing: {
                "none": { energy: 0, water: 0, yield: 1.00, loss: 0.000 },
                "pasteurization": { energy: 0.05, water: 0.50, yield: 0.995, loss: 0.005 },
                "sterilization": { energy: 0.12, water: 0.70, yield: 0.980, loss: 0.020 },
                "baking": { energy: 0.40, water: 0.10, yield: 0.970, loss: 0.030 },
                "frying": { energy: 0.35, water: 0.05, yield: 0.965, loss: 0.035 },
                "freezing": { energy: 0.55, water: 0.20, yield: 0.990, loss: 0.010 },
                "drying": { energy: 1.50, water: 0.80, yield: 0.950, loss: 0.050 },
                "milling": { energy: 0.03, water: 0.05, yield: 0.985, loss: 0.015 },
                "mixing": { energy: 0.01, water: 0.15, yield: 0.998, loss: 0.002 }
            },

            // TRANSPORTATION FROM GEMINI TABLE D
            transportation: {
                "road": { co2: 0.075, refrigerated: 0.20 },
                "rail": { co2: 0.015, refrigerated: 0.00 },
                "sea": { co2: 0.010, refrigerated: 0.05 },
                "air": { co2: 0.950, refrigerated: 0.00 },
                "lastmile": { co2: 0.350, refrigerated: 0.00 }
            },

            // PACKAGING FROM GEMINI TABLE B
            packaging: {
                "cardboard": { co2: 1.30, r1: 0.60, r2: 0.72, q: 0.95 },
                "PET": { co2: 2.30, r1: 0.70, r2: 0.45, q: 1.00 },
                "HDPE": { co2: 1.95, r1: 0.30, r2: 0.38, q: 0.90 },
                "LDPE": { co2: 1.85, r1: 0.20, r2: 0.36, q: 0.80 },
                "PP": { co2: 2.05, r1: 0.25, r2: 0.40, q: 0.85 },
                "glass": { co2: 0.65, r1: 0.85, r2: 0.80, q: 1.00 },
                "aluminum": { co2: 8.50, r1: 0.95, r2: 0.75, q: 1.00 },
                "steel": { co2: 1.90, r1: 0.95, r2: 0.84, q: 1.00 },
                "PLA": { co2: 1.70, r1: 0.05, r2: 0.01, q: 0.80 }
            }
        };

        let selectedIngredients = [];
        let currentChart = null;

        function initApp() {
            populateIngredientSelect();
            populateCountrySelect();
            setupDemoData();
            calculateImpact();
            updateTabIndicator();
        }

        function populateIngredientSelect() {
            const select = document.getElementById('ingredientSelect');
            select.innerHTML = '<option value="">Choose from 35+ ingredients...</option>';
            
            for (const [key, ingredient] of Object.entries(aioxyData.ingredients)) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = ingredient.name;
                select.appendChild(option);
            }
        }

        function populateCountrySelect() {
            const select = document.getElementById('manufacturingCountry');
            select.innerHTML = '<option value="">Select country...</option>';
            
            for (const [code, country] of Object.entries(aioxyData.countries)) {
                const option = document.createElement('option');
                option.value = code;
                option.textContent = country.name;
                if (code === 'FR') option.selected = true;
                select.appendChild(option);
            }
        }

        function setupDemoData() {
            selectedIngredients = [
                { id: 'peas', name: 'Peas (Dried)', quantity: 0.15, data: aioxyData.ingredients.peas },
                { id: 'wheat', name: 'Wheat (Grain)', quantity: 0.10, data: aioxyData.ingredients.wheat },
                { id: 'tomatoes', name: 'Tomatoes (Fresh, Field)', quantity: 0.05, data: aioxyData.ingredients.tomatoes }
            ];
            updateIngredientList();
        }

        function addIngredient() {
            const select = document.getElementById('ingredientSelect');
            const quantityInput = document.getElementById('ingredientQuantity');
            
            const ingredientId = select.value;
            const quantity = parseFloat(quantityInput.value);
            
            if (!ingredientId || isNaN(quantity) || quantity <= 0) {
                alert('Please select an ingredient and enter a valid quantity');
                return;
            }
            
            const ingredient = aioxyData.ingredients[ingredientId];
            selectedIngredients.push({
                id: ingredientId,
                name: ingredient.name,
                quantity: quantity,
                data: ingredient
            });
            
            updateIngredientList();
            calculateImpact();
            
            select.value = '';
            quantityInput.value = '0.150';
        }

        function removeIngredient(index) {
            selectedIngredients.splice(index, 1);
            updateIngredientList();
            calculateImpact();
        }

        function updateIngredientList() {
            const list = document.getElementById('ingredientList');
            list.innerHTML = '';
            
            if (selectedIngredients.length === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-apple-alt"></i>
                        <h3>No ingredients added yet</h3>
                        <p>Add ingredients to calculate your environmental impact</p>
                    </div>
                `;
                return;
            }
            
            selectedIngredients.forEach((ingredient, index) => {
                const item = document.createElement('div');
                item.className = 'ingredient-item';
                item.innerHTML = `
                    <div class="ingredient-info">
                        <div class="ingredient-name">${ingredient.name}</div>
                        <div class="ingredient-stats">
                            ${ingredient.data.co2} kg CO₂e/kg • ${ingredient.data.waterBlue + ingredient.data.waterGreen + ingredient.data.waterGrey} L water/kg
                        </div>
                    </div>
                    <div class="ingredient-actions">
                        <input type="number" class="quantity-input" value="${ingredient.quantity}" step="0.001" min="0" 
                               onchange="updateIngredientQuantity(${index}, this.value)">
                        <button class="remove-btn" onclick="removeIngredient(${index})">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function updateIngredientQuantity(index, newQuantity) {
            selectedIngredients[index].quantity = parseFloat(newQuantity);
            calculateImpact();
        }

        function toggleAdvanced() {
            const advanced = document.getElementById('advancedOptions');
            advanced.classList.toggle('hidden');
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            event.currentTarget.classList.add('active');
            
            if (tabName === 'results') calculateImpact();
            
            updateTabIndicator();
        }

        function updateTabIndicator() {
            const activeTab = document.querySelector('.nav-tab.active');
            const indicator = document.getElementById('tabIndicator');
            
            if (activeTab && indicator) {
                indicator.style.left = activeTab.offsetLeft + 'px';
                indicator.style.width = activeTab.offsetWidth + 'px';
            }
        }

        function calculateImpact() {
            if (selectedIngredients.length === 0) return;

            const loadingElement = document.getElementById('loadingResults');
            const resultsContent = document.getElementById('resultsContent');
            
            loadingElement.classList.remove('hidden');
            resultsContent.classList.add('hidden');

            setTimeout(() => {
                const results = performCalculations();
                updateResultsUI(results);
                
                loadingElement.classList.add('hidden');
                resultsContent.classList.remove('hidden');
            }, 800);
        }

        function performCalculations() {
            // Get all inputs
            const countryCode = document.getElementById('manufacturingCountry').value || 'FR';
            const processingType = document.getElementById('processingMethod').value;
            const transportMode = document.getElementById('transportMode').value;
            const transportDistance = parseFloat(document.getElementById('transportDistance').value) || 0;
            const packagingType = document.getElementById('packagingMaterial').value;
            const packagingWeight = parseFloat(document.getElementById('packagingWeight').value) || 0;
            const recycledContent = parseFloat(document.getElementById('recycledContent').value) || 0;
            const isRefrigerated = document.getElementById('refrigeratedTransport').value === 'yes';

            const country = aioxyData.countries[countryCode];
            const processing = aioxyData.processing[processingType];
            const transport = aioxyData.transportation[transportMode];
            const packaging = aioxyData.packaging[packagingType];

            // Calculate ingredient impacts with food loss adjustment
            let totalCO2 = 0;
            let totalWaterBlue = 0;
            let totalWaterGreen = 0;
            let totalWaterGrey = 0;
            let totalLandUse = 0;
            let totalWeight = 0;

            selectedIngredients.forEach(ingredient => {
                const adjustedQuantity = ingredient.quantity / (1 - ingredient.data.loss);
                
                totalCO2 += adjustedQuantity * ingredient.data.co2;
                totalWaterBlue += adjustedQuantity * ingredient.data.waterBlue;
                totalWaterGreen += adjustedQuantity * ingredient.data.waterGreen;
                totalWaterGrey += adjustedQuantity * ingredient.data.waterGrey;
                totalLandUse += adjustedQuantity * ingredient.data.landUse;
                totalWeight += ingredient.quantity;
            });

            // Add processing impact with regional electricity factor
            const processingCO2 = processing.energy * (country.electricityCO2 / 1000) * totalWeight;
            totalCO2 += processingCO2;
            totalWeight *= processing.yield;

            // Add transportation impact
            let transportCO2 = transportDistance * transport.co2 * (totalWeight / 1000);
            if (isRefrigerated) {
                transportCO2 *= (1 + transport.refrigerated);
            }
            totalCO2 += transportCO2;

            // Add packaging impact with CFF calculation
            const packagingCO2 = calculateCFFImpact(packaging, packagingWeight, recycledContent);
            totalCO2 += packagingCO2;

            // Calculate water scarcity using AWARE method
            const waterScarcity = calculateAWAREImpact(totalWaterBlue, country.awareFactor);

            // Calculate per kg values
            const co2PerKg = totalWeight > 0 ? totalCO2 / totalWeight : 0;
            const waterPerKg = totalWeight > 0 ? (totalWaterBlue + totalWaterGreen + totalWaterGrey) / totalWeight : 0;
            const landUsePerKg = totalWeight > 0 ? totalLandUse / totalWeight : 0;

            // Calculate savings vs industry average
            const industryAvgCO2 = 3.5;
            const industryAvgWater = 600;
            
            const co2Saved = Math.max(industryAvgCO2 - co2PerKg, 0) * totalWeight;
            const waterSaved = Math.max(industryAvgWater - waterPerKg, 0) * totalWeight;
            
            const co2SavingsPercent = totalWeight > 0 ? ((co2Saved / (industryAvgCO2 * totalWeight)) * 100) : 0;
            const waterSavingsPercent = totalWeight > 0 ? ((waterSaved / (industryAvgWater * totalWeight)) * 100) : 0;

            return {
                co2PerKg, waterPerKg, landUsePerKg, waterScarcity,
                co2Saved, waterSaved, co2SavingsPercent, waterSavingsPercent,
                processingCO2, transportCO2, packagingCO2,
                ingredientsCO2: totalCO2 - processingCO2 - transportCO2 - packagingCO2
            };
        }

        // GROK RECOMMENDATION: CFF Calculation
        function calculateCFFImpact(packaging, weight, recycledContent) {
            const R1 = Math.min(recycledContent / 100, packaging.r1);
            const virginImpact = packaging.co2 * weight * (1 - R1);
            const recycledImpact = packaging.co2 * weight * R1 * packaging.q;
            return virginImpact + recycledImpact;
        }

        // GROK RECOMMENDATION: AWARE Water Scarcity
        function calculateAWAREImpact(waterBlue, awareFactor) {
            const consumption_m3_per_kg = waterBlue / 1000.0;
            const cf_constrained = Math.min(Math.max(awareFactor, 0.1), 100.0);
            return consumption_m3_per_kg * cf_constrained;
        }

        function updateResultsUI(results) {
            document.getElementById('co2Value').textContent = results.co2PerKg.toFixed(2) + ' kg';
            document.getElementById('waterValue').textContent = Math.round(results.waterPerKg) + ' L';
            document.getElementById('landValue').textContent = results.landUsePerKg.toFixed(2) + ' m²';
            document.getElementById('waterScarcityValue').textContent = results.waterScarcity.toFixed(3);
            
            document.getElementById('co2Savings').textContent = results.co2SavingsPercent.toFixed(1) + '% saved';
            document.getElementById('waterSavings').textContent = results.waterSavingsPercent.toFixed(1) + '% saved';

            // Environmental story
            const storyContent = document.getElementById('storyContent');
            if (results.co2Saved > 0) {
                const carKm = (results.co2Saved * 1000 / 120).toFixed(0);
                const showers = (results.waterSaved / 60).toFixed(0);
                storyContent.innerHTML = `
                    <div class="story-highlight">
                        <i class="fas fa-seedling"></i>
                        <strong>${results.co2Saved.toFixed(1)} kg CO₂e saved</strong> - equivalent to not driving ${carKm} km in a standard car
                    </div>
                    <div class="story-highlight">
                        <i class="fas fa-tint"></i>
                        <strong>${Math.round(results.waterSaved)} liters of water saved</strong> - enough for ${showers} average showers
                    </div>
                    <p>
                        Your product demonstrates a commitment to sustainability with a carbon footprint ${results.co2SavingsPercent.toFixed(1)}% lower than industry average. 
                        This achievement reflects thoughtful ingredient selection and efficient supply chain management. 
                        The water savings highlight responsible resource use in regions facing water scarcity challenges.
                    </p>
                `;
            } else {
                storyContent.innerHTML = `
                    <div class="story-highlight">
                        Consider optimizing your ingredient selection and supply chain for better sustainability performance.
                    </div>
                    <p>
                        While your current product meets basic requirements, there are opportunities to further reduce environmental impact. 
                        Consider plant-based alternatives, regional sourcing, and energy-efficient processing methods to improve your sustainability profile.
                    </p>
                `;
            }

            createEmissionChart(results);
        }

        function createEmissionChart(results) {
            const ctx = document.getElementById('emissionChart').getContext('2d');
            
            if (currentChart) currentChart.destroy();
            
            currentChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Ingredients', 'Processing', 'Transportation', 'Packaging'],
                    datasets: [{
                        data: [
                            Math.max(results.ingredientsCO2, 0),
                            Math.max(results.processingCO2, 0),
                            Math.max(results.transportCO2, 0),
                            Math.max(results.packagingCO2, 0)
                        ],
                        backgroundColor: ['#2E86C1', '#27AE60', '#F39C12', '#E74C3C'],
                        borderWidth: 3,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: {
                                    size: 13,
                                    weight: '600'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(10, 37, 64, 0.9)',
                            titleFont: {
                                size: 14
                            },
                            bodyFont: {
                                size: 13
                            },
                            padding: 12,
                            cornerRadius: 8
                        }
                    },
                    cutout: '65%'
                }
            });
        }

        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
    </html>
