<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIOXY | Food Emissions Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2E8B57;
            --primary-dark: #1F6B45;
            --secondary: #FF6B35;
            --light: #F8F9FA;
            --dark: #343A40;
            --border: #DEE2E6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: var(--primary);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header .tagline {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .access-control {
            background: var(--light);
            padding: 20px;
            border-bottom: 1px solid var(--border);
            text-align: center;
        }
        
        .access-form {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .access-form input {
            padding: 10px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            min-width: 200px;
        }
        
        .access-form button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .access-form button:hover {
            background: #e55a2b;
        }
        
        .usage-counter {
            margin-top: 10px;
            font-size: 0.9em;
            color: var(--dark);
        }
        
        .calculator-section {
            display: none;
            padding: 30px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--dark);
        }
        
        .form-group input, .form-group select {
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .calculate-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
            width: 100%;
            margin-top: 20px;
        }
        
        .calculate-btn:hover {
            background: var(--primary-dark);
        }
        
        .results-section {
            display: none;
            padding: 30px;
            background: var(--light);
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .product-title {
            font-size: 2em;
            color: var(--primary);
            font-weight: 700;
        }
        
        .impact-numbers {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .impact-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-left: 4px solid var(--primary);
        }
        
        .impact-value {
            font-size: 2em;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }
        
        .impact-label {
            color: var(--dark);
            font-size: 0.9em;
        }
        
        .charts-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .charts-comparison {
                grid-template-columns: 1fr;
            }
        }
        
        .chart-container, .comparison-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .impact-stories {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .story-card {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid var(--secondary);
        }
        
        .comparison-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .comparison-btn {
            background: var(--border);
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .comparison-btn.active {
            background: var(--primary);
            color: white;
        }
        
        .comparison-results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            text-align: center;
        }
        
        .comparison-item {
            padding: 15px;
            border-radius: 8px;
            background: var(--light);
        }
        
        .comparison-winner {
            border: 2px solid var(--secondary);
            background: #FFF9F7;
        }
        
        .reset-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            margin-top: 20px;
        }
        
        .reset-btn:hover {
            background: #e55a2b;
        }
        
        .access-denied {
            text-align: center;
            padding: 40px;
            color: var(--dark);
        }
        
        .qr-display {
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .mock-qr {
            width: 200px;
            height: 200px;
            background: var(--light);
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--border);
            border-radius: 12px;
            font-size: 1.2em;
            color: var(--dark);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌱 AIOXY</h1>
            <p class="tagline">Food Emissions Calculator - EU PEF Compliant</p>
        </div>

        <div class="access-control">
            <div class="access-form">
                <input type="password" id="accessCode" placeholder="Enter access code (AIOXY2024 for founder)">
                <button onclick="checkAccess()">Access Calculator</button>
            </div>
            <div class="usage-counter" id="usageCounter">
                Public uses remaining: 3
            </div>
        </div>

        <div class="access-denied" id="accessDenied">
            <h2>🔒 Access Required</h2>
            <p>Enter valid access code to use the AIOXY Emissions Calculator</p>
            <p><small>Founder access: AIOXY2024 | Public: 3 free uses</small></p>
        </div>

        <div class="calculator-section" id="calculatorSection">
            <div class="form-grid">
                <div class="form-group">
                    <label for="productName">Product Name *</label>
                    <input type="text" id="productName" placeholder="e.g., Premium Beef Burger" required>
                </div>

                <div class="form-group">
                    <label for="ingredientSelect">Primary Ingredient *</label>
                    <select id="ingredientSelect" required>
                        <option value="">-- Select Ingredient --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="weight">Weight (kg) *</label>
                    <input type="number" id="weight" placeholder="e.g., 0.5" step="0.1" min="0.1" required>
                </div>

                <div class="form-group">
                    <label for="originCountry">Origin Country *</label>
                    <select id="originCountry" required>
                        <option value="">-- Select Country --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="processing">Processing Method</label>
                    <select id="processing">
                        <option value="">-- Select Processing --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="transportMode">Transport Mode</label>
                    <select id="transportMode">
                        <option value="">-- Select Transport --</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="distance">Transport Distance (km)</label>
                    <input type="number" id="distance" placeholder="e.g., 500" min="0">
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="refrigerated"> Refrigerated Transport
                    </label>
                </div>
            </div>

            <button class="calculate-btn" onclick="calculateFootprint()">Calculate Environmental Footprint</button>

            <div class="results-section" id="resultsSection">
                <div class="results-header">
                    <h2 class="product-title" id="resultProductName">Product Name</h2>
                    <button class="reset-btn" onclick="resetCalculator()">Calculate New Product</button>
                </div>

                <div class="qr-display">
                    <h3>📱 SCAN FOR FOOTPRINT</h3>
                    <div class="mock-qr">
                        AIOXY<br>VERIFIED<br>FOOTPRINT
                    </div>
                    <p><small>Scan this QR code to view this product's environmental impact</small></p>
                </div>

                <div class="impact-numbers">
                    <div class="impact-card">
                        <div class="impact-label">CARBON FOOTPRINT</div>
                        <div class="impact-value" id="co2Value">0.0</div>
                        <div class="impact-label">kg CO₂e</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-label">WATER FOOTPRINT</div>
                        <div class="impact-value" id="waterValue">0.0</div>
                        <div class="impact-label">liters (blue water)</div>
                    </div>
                    <div class="impact-card">
                        <div class="impact-label">LAND USE</div>
                        <div class="impact-value" id="landValue">0.0</div>
                        <div class="impact-label">m²</div>
                    </div>
                </div>

                <div class="impact-stories">
                    <h3>🌍 Your Impact Story</h3>
                    <div id="impactStories"></div>
                </div>

                <div class="charts-comparison">
                    <div class="chart-container">
                        <h3>📊 Emissions Breakdown</h3>
                        <canvas id="emissionsChart"></canvas>
                    </div>
                    
                    <div class="comparison-container">
                        <h3>⚖️ Quick Comparison</h3>
                        <div class="comparison-options">
                            <button class="comparison-btn active" onclick="showComparison('beefVsPlant')">Beef vs Plant</button>
                            <button class="comparison-btn" onclick="showComparison('countryComparison')">Country Impact</button>
                            <button class="comparison-btn" onclick="showComparison('transportComparison')">Transport Modes</button>
                        </div>
                        <div id="comparisonResults"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== AIOXY REGULATORY DATA ENGINE ====================
        const AIOXY_DATA = {
            ingredients: {
                "Wheat (EU Average)": { co2: 0.48, waterBlue: 15.0, land: 1.10, category: "Grains & Cereals", allocation: "Mass" },
                "Rice (Paddy, Global)": { co2: 1.90, waterBlue: 250.0, land: 1.50, category: "Grains & Cereals", allocation: "Mass" },
                "Corn (Maize)": { co2: 0.65, waterBlue: 40.0, land: 0.90, category: "Grains & Cereals", allocation: "Mass" },
                "Soybeans (Global Avg)": { co2: 0.85, waterBlue: 30.0, land: 1.80, category: "Pulses & Legumes", allocation: "Mass" },
                "Chickpeas": { co2: 0.70, waterBlue: 5.0, land: 1.20, category: "Pulses & Legumes", allocation: "Mass" },
                "Beef (Cattle, EU Intensive)": { co2: 25.0, waterBlue: 100.0, land: 45.0, category: "Animal Products", allocation: "Economic/Mass Mix" },
                "Chicken (Broiler)": { co2: 2.50, waterBlue: 20.0, land: 3.00, category: "Animal Products", allocation: "Economic" },
                "Pork (EU Intensive)": { co2: 5.00, waterBlue: 45.0, land: 8.00, category: "Animal Products", allocation: "Economic" },
                "Milk (Cow, EU Avg)": { co2: 1.10, waterBlue: 15.0, land: 1.50, category: "Animal Products", allocation: "Economic" },
                "Salmon (Farm Raised)": { co2: 3.50, waterBlue: 50.0, land: 0.20, category: "Animal Products", allocation: "Economic" },
                "Apples (EU Avg)": { co2: 0.30, waterBlue: 30.0, land: 0.40, category: "Fruits", allocation: "Mass" },
                "Bananas (Imported)": { co2: 0.90, waterBlue: 80.0, land: 0.55, category: "Fruits", allocation: "Mass" },
                "Tomatoes (Open Field, EU)": { co2: 0.25, waterBlue: 40.0, land: 0.35, category: "Vegetables", allocation: "Mass" },
                "Potatoes (EU)": { co2: 0.20, waterBlue: 25.0, land: 0.45, category: "Vegetables", allocation: "Mass" },
                "Almonds": { co2: 5.50, waterBlue: 1000.0, land: 2.50, category: "Nuts & Seeds", allocation: "Mass" },
                "Coffee (Green bean)": { co2: 18.0, waterBlue: 250.0, land: 2.50, category: "Beverage Crops", allocation: "Mass" },
                "Cocoa (Bean)": { co2: 10.0, waterBlue: 150.0, land: 2.00, category: "Beverage Crops", allocation: "Mass" }
            },

            countries: {
                "Germany": { electricity: 341, aware: 1.8, recyclingPlastic: 47.9 },
                "France": { electricity: 59, aware: 1.2, recyclingPlastic: 26.6 },
                "Italy": { electricity: 255, aware: 2.5, recyclingPlastic: 49.0 },
                "Spain": { electricity: 142, aware: 3.5, recyclingPlastic: 39.5 },
                "Poland": { electricity: 594, aware: 1.5, recyclingPlastic: 34.6 },
                "Sweden": { electricity: 41, aware: 0.8, recyclingPlastic: 32.0 },
                "USA": { electricity: 400, aware: 2.0, recyclingPlastic: 13.0 },
                "China": { electricity: 610, aware: 3.0, recyclingPlastic: 20.0 }
            },

            processing: {
                "Pasteurization": { energy: 0.040 },
                "Baking": { energy: 0.250 },
                "Freezing": { energy: 0.080 },
                "Milling/Grinding": { energy: 0.015 },
                "Frying": { energy: 0.150 }
            },

            transport: {
                "HGV (40t)": { co2: 0.058, refrigeratedPremium: 0.15 },
                "Light Commercial Vehicle": { co2: 0.150, refrigeratedPremium: 0.10 },
                "Container Ship": { co2: 0.009, refrigeratedPremium: 0.20 },
                "Cargo Plane": { co2: 0.750, refrigeratedPremium: 0.00 },
                "Electric Rail (EU Avg)": { co2: 0.015, refrigeratedPremium: 0.10 }
            },

            losses: {
                "Grains & Cereals": { harvest: 0.945, processing: 0.975, distribution: 0.990, retail: 0.985 },
                "Fruits & Vegetables": { harvest: 0.880, processing: 0.950, distribution: 0.970, retail: 0.960 },
                "Animal Products (Meat)": { processing: 0.970, distribution: 0.985 }
            }
        };

        const IMPACT_STORIES = {
            co2: [
                { threshold: 1.0, text: "Saving 1 kg CO₂e equals driving 3 miles in a petrol car." },
                { threshold: 2.0, text: "Saving 2 kg CO₂e is like charging 250 smartphones." },
                { threshold: 5.0, text: "Saving 5 kg CO₂e equals the energy to power a laptop for 2 weeks." },
                { threshold: 10.0, text: "Saving 10 kg CO₂e equals the carbon absorbed by a tree in one month." }
            ],
            water: [
                { threshold: 50, text: "Saving 50L blue water provides drinking water for 50 days." },
                { threshold: 100, text: "Saving 100L blue water equals a 5-minute shower." },
                { threshold: 500, text: "Saving 500L blue water can produce 1 kg of potatoes." }
            ]
        };

        // ==================== ACCESS CONTROL ====================
        let usageCount = 3;
        let hasFounderAccess = false;

        function checkAccess() {
            const accessCode = document.getElementById('accessCode').value;
            
            if (accessCode === 'AIOXY2024') {
                hasFounderAccess = true;
                showCalculator();
            } else if (usageCount > 0) {
                usageCount--;
                updateUsageCounter();
                showCalculator();
            } else {
                alert('No public uses remaining. Contact for founder access.');
            }
        }

        function updateUsageCounter() {
            document.getElementById('usageCounter').textContent = 
                `Public uses remaining: ${usageCount}`;
        }

        function showCalculator() {
            document.getElementById('accessDenied').style.display = 'none';
            document.getElementById('calculatorSection').style.display = 'block';
            populateDropdowns();
        }

        // ==================== INITIALIZATION ====================
        function populateDropdowns() {
            const ingredientSelect = document.getElementById('ingredientSelect');
            const countrySelect = document.getElementById('originCountry');
            const processingSelect = document.getElementById('processing');
            const transportSelect = document.getElementById('transportMode');

            Object.keys(AIOXY_DATA.ingredients).forEach(ingredient => {
                const option = document.createElement('option');
                option.value = ingredient;
                option.textContent = ingredient;
                ingredientSelect.appendChild(option);
            });

            Object.keys(AIOXY_DATA.countries).forEach(country => {
                const option = document.createElement('option');
                option.value = country;
                option.textContent = country;
                countrySelect.appendChild(option);
            });

            Object.keys(AIOXY_DATA.processing).forEach(method => {
                const option = document.createElement('option');
                option.value = method;
                option.textContent = method;
                processingSelect.appendChild(option);
            });

            Object.keys(AIOXY_DATA.transport).forEach(mode => {
                const option = document.createElement('option');
                option.value = mode;
                option.textContent = mode;
                transportSelect.appendChild(option);
            });
        }

        // ==================== CALCULATION ENGINE ====================
        function calculateFootprint() {
            const productData = gatherProductData();
            if (!productData) return;

            const results = performCalculations(productData);
            displayResults(productData, results);
        }

        function gatherProductData() {
            const productName = document.getElementById('productName').value;
            const ingredient = document.getElementById('ingredientSelect').value;
            const weight = parseFloat(document.getElementById('weight').value);
            const originCountry = document.getElementById('originCountry').value;
            const processing = document.getElementById('processing').value;
            const transportMode = document.getElementById('transportMode').value;
            const distance = parseFloat(document.getElementById('distance').value) || 0;
            const refrigerated = document.getElementById('refrigerated').checked;

            if (!productName || !ingredient || !weight || !originCountry) {
                alert('Please fill all required fields (Product Name, Ingredient, Weight, Origin Country)');
                return null;
            }

            return {
                productName,
                ingredient,
                weight,
                originCountry,
                processing,
                transportMode,
                distance,
                refrigerated
            };
        }

        function performCalculations(productData) {
            const ingredient = AIOXY_DATA.ingredients[productData.ingredient];
            const country = AIOXY_DATA.countries[productData.originCountry];
            const process = AIOXY_DATA.processing[productData.processing] || { energy: 0 };
            const transport = AIOXY_DATA.transport[productData.transportMode] || { co2: 0, refrigeratedPremium: 0 };

            // 1. INGREDIENT FOOTPRINT (with loss factors) - PEF COMPLIANT
            const lossProfile = getLossProfile(ingredient.category);
            const totalLossFactor = lossProfile.harvest * lossProfile.processing * lossProfile.distribution * lossProfile.retail;
            const adjustedWeight = productData.weight / totalLossFactor;

            let ingredientCO2 = ingredient.co2 * adjustedWeight;
            let ingredientWater = ingredient.waterBlue * adjustedWeight * country.aware; // AWARE FACTOR APPLIED
            let ingredientLand = ingredient.land * adjustedWeight;

            // 2. PROCESSING FOOTPRINT (Country-specific electricity) - PEF COMPLIANT
            let processingCO2 = 0;
            if (process.energy > 0) {
                const electricityCO2 = process.energy * country.electricity / 1000;
                processingCO2 = electricityCO2 * productData.weight;
            }

            // 3. TRANSPORT FOOTPRINT (GLEC v3.1 compliant)
            let transportCO2 = transport.co2 * productData.distance * productData.weight;
            if (productData.refrigerated) {
                transportCO2 *= (1 + transport.refrigeratedPremium);
            }

            const totalCO2 = ingredientCO2 + processingCO2 + transportCO2;
            const totalWater = ingredientWater;

            return {
                total: {
                    co2: parseFloat(totalCO2.toFixed(2)),
                    water: parseFloat(totalWater.toFixed(2)),
                    land: parseFloat(ingredientLand.toFixed(2))
                },
                breakdown: {
                    ingredient: parseFloat(ingredientCO2.toFixed(2)),
                    processing: parseFloat(processingCO2.toFixed(2)),
                    transport: parseFloat(transportCO2.toFixed(2))
                }
            };
        }

        function getLossProfile(category) {
            const defaultProfile = { harvest: 1, processing: 1, distribution: 1, retail: 1 };
            
            if (category.includes('Grains')) return AIOXY_DATA.losses['Grains & Cereals'] || defaultProfile;
            if (category.includes('Fruits') || category.includes('Vegetables')) return AIOXY_DATA.losses['Fruits & Vegetables'] || defaultProfile;
            if (category.includes('Animal')) return AIOXY_DATA.losses['Animal Products (Meat)'] || defaultProfile;
            
            return defaultProfile;
        }

        // ==================== RESULTS DISPLAY ====================
        function displayResults(productData, results) {
            document.getElementById('resultProductName').textContent = productData.productName;
            document.getElementById('co2Value').textContent = results.total.co2;
            document.getElementById('waterValue').textContent = results.total.water;
            document.getElementById('landValue').textContent = results.total.land;

            displayImpactStories(results.total.co2, results.total.water);
            createEmissionsChart(results.breakdown);
            showComparison('beefVsPlant');

            document.getElementById('resultsSection').style.display = 'block';
        }

        function displayImpactStories(co2, water) {
            const storiesContainer = document.getElementById('impactStories');
            storiesContainer.innerHTML = '';

            const co2Stories = IMPACT_STORIES.co2.filter(story => co2 >= story.threshold);
            if (co2Stories.length > 0) {
                const bestCo2Story = co2Stories[co2Stories.length - 1];
                const storyElement = document.createElement('div');
                storyElement.className = 'story-card';
                storyElement.innerHTML = `🔥 <strong>Carbon Impact:</strong> ${bestCo2Story.text}`;
                storiesContainer.appendChild(storyElement);
            }

            const waterStories = IMPACT_STORIES.water.filter(story => water >= story.threshold);
            if (waterStories.length > 0) {
                const bestWaterStory = waterStories[waterStories.length - 1];
                const storyElement = document.createElement('div');
                storyElement.className = 'story-card';
                storyElement.innerHTML = `💧 <strong>Water Impact:</strong> ${bestWaterStory.text}`;
                storiesContainer.appendChild(storyElement);
            }

            if (co2Stories.length === 0 && waterStories.length === 0) {
                storiesContainer.innerHTML = '<div class="story-card">Every small reduction makes a difference! 🌍</div>';
            }
        }

        function createEmissionsChart(breakdown) {
            const ctx = document.getElementById('emissionsChart').getContext('2d');
            
            if (window.emissionsChartInstance) {
                window.emissionsChartInstance.destroy();
            }

            window.emissionsChartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Ingredients', 'Processing', 'Transport'],
                    datasets: [{
                        data: [breakdown.ingredient, breakdown.processing, breakdown.transport],
                        backgroundColor: ['#2E8B57', '#FF6B35', '#667eea'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.raw} kg CO₂e`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function showComparison(type) {
            const comparisonResults = document.getElementById('comparisonResults');
            const buttons = document.querySelectorAll('.comparison-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            let comparisonHTML = '';

            if (type === 'beefVsPlant') {
                const beefCO2 = AIOXY_DATA.ingredients["Beef (Cattle, EU Intensive)"].co2 * 0.5;
                const chickenCO2 = AIOXY_DATA.ingredients["Chicken (Broiler)"].co2 * 0.5;
                const soyCO2 = AIOXY_DATA.ingredients["Soybeans (Global Avg)"].co2 * 0.5;
                
                comparisonHTML = `
                    <div class="comparison-results">
                        <div class="comparison-item ${beefCO2 > soyCO2 ? '' : 'comparison-winner'}">
                            <h4>🌱 Plant Protein</h4>
                            <div class="impact-value">${soyCO2.toFixed(2)}</div>
                            <div class="impact-label">kg CO₂e (0.5kg Soy)</div>
                        </div>
                        <div class="comparison-item ${beefCO2 > soyCO2 ? 'comparison-winner' : ''}">
                            <h4>🥩 Beef Protein</h4>
                            <div class="impact-value">${beefCO2.toFixed(2)}</div>
                            <div class="impact-label">kg CO₂e (0.5kg Beef)</div>
                        </div>
                    </div>
                    <p style="text-align: center; margin-top: 15px; font-size: 0.9em;">
                        Beef produces <strong>${(beefCO2/soyCO2).toFixed(1)}x</strong> more emissions than plant protein
                    </p>
                `;
            }
            else if (type === 'countryComparison') {
                const franceCO2 = AIOXY_DATA.ingredients["Tomatoes (Open Field, EU)"].co2 * 0.5 * (1 + (AIOXY_DATA.processing["Pasteurization"].energy * AIOXY_DATA.countries["France"].electricity / 1000));
                const polandCO2 = AIOXY_DATA.ingredients["Tomatoes (Open Field, EU)"].co2 * 0.5 * (1 + (AIOXY_DATA.processing["Pasteurization"].energy * AIOXY_DATA.countries["Poland"].electricity / 1000));
                
                comparisonHTML = `
                    <div class="comparison-results">
                        <div class="comparison-item ${franceCO2 < polandCO2 ? 'comparison-winner' : ''}">
                            <h4>🇫🇷 France</h4>
                            <div class="impact-value">${franceCO2.toFixed(2)}</div>
                            <div class="impact-label">kg CO₂e (0.5kg Tomatoes)</div>
                        </div>
                        <div class="comparison-item ${franceCO2 < polandCO2 ? '' : 'comparison-winner'}">
                            <h4>🇵🇱 Poland</h4>
                            <div class="impact-value">${polandCO2.toFixed(2)}</div>
                            <div class="impact-label">kg CO₂e (0.5kg Tomatoes)</div>
                        </div>
                    </div>
                    <p style="text-align: center; margin-top: 15px; font-size: 0.9em;">
                        Cleaner energy grid reduces processing emissions by <strong>${((polandCO2-franceCO2)/polandCO2*100).toFixed(0)}%</strong>
                    </p>
                `;
            }
            else if (type === 'transportComparison') {
                const shipCO2 = AIOXY_DATA.transport["Container Ship"].co2 * 1000 * 0.5;
                const planeCO2 = AIOXY_DATA.transport["Cargo Plane"].co2 * 1000 * 0.5;
                
                comparisonHTML = `
                    <div class="comparison-results">
                        <div class="comparison-item ${shipCO2 < planeCO2 ? 'comparison-winner' : ''}">
                            <h4>🚢 Sea Transport</h4>
                            <div class="impact-value">${shipCO2.toFixed(2)}</div>
                            <div class="impact-label">kg CO₂e (1000km)</div>
                        </div>
                        <div class="comparison-item ${shipCO2 < planeCO2 ? '' : 'comparison-winner'}">
                            <h4>✈️ Air Transport</h4>
                            <div class="impact-value">${planeCO2.toFixed(2)}</div>
                            <div class="impact-label">kg CO₂e (1000km)</div>
                        </div>
                    </div>
                    <p style="text-align: center; margin-top: 15px; font-size: 0.9em;">
                        Shipping produces <strong>${(planeCO2/shipCO2).toFixed(0)}x</strong> less emissions than air freight
                    </p>
                `;
            }

            comparisonResults.innerHTML = comparisonHTML;
        }

        function resetCalculator() {
            document.getElementById('productForm').reset();
            document.getElementById('resultsSection').style.display = 'none';
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('accessDenied').style.display = 'block';
            document.getElementById('calculatorSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'none';
        });
    </script>
</body>
</html>
